window.germanized=window.germanized||{},window.germanized.admin=window.germanized.admin||{},function(i,o,d,r){var a=function(e){var o=this;o.params=wc_gzd_admin_shipment_modal_params,o.$modalTrigger=e,o.destroy(),o.setup(),o.$modalTrigger.on("click.gzd-modal-"+o.modalId,{adminShipmentModal:o},o.onClick),i(d.body).on("wc_backbone_modal_loaded.gzd-modal-"+o.modalId,{adminShipmentModal:o},o.onOpen).on("wc_backbone_modal_response.gzd-modal-"+o.modalId,{adminShipmentModal:o},o.response).on("wc_backbone_modal_before_remove.gzd-modal-"+o.modalId,{adminShipmentModal:o},o.onClose)};a.prototype.setup=function(){var e=this;e.referenceId=e.$modalTrigger.data("reference")?e.$modalTrigger.data("reference"):0,e.modalClass=e.$modalTrigger.data("id"),e.modalId=e.modalClass+"-"+e.referenceId,e.loadAsync=!!e.$modalTrigger.data("load-async")&&e.$modalTrigger.data("load-async"),e.nonceParams=e.$modalTrigger.data("nonce-params")?e.$modalTrigger.data("nonce-params"):"wc_gzd_admin_shipments_params",e.$modal=!1,e.$modalTrigger.data("self",this)},a.prototype.destroy=function(){var e=this;e.$modalTrigger.off(".gzd-modal-"+e.modalId),i(d).off(".gzd-modal-"+e.modalId),i(d.body).off(".gzd-modal-"+e.modalId)},a.prototype.getShipment=function(e){return i("#panel-order-shipments").find("#shipment-"+e)},a.prototype.onRemoveNotice=function(e){e.data.adminShipmentModal;return i(this).parents(".notice").slideUp(150,function(){i(this).remove()}),!1},a.prototype.onClick=function(e){e=e.data.adminShipmentModal;return e.$modalTrigger.WCBackboneModal({template:e.modalId}),!1},a.prototype.parseFieldId=function(e){return e.replace("[","_").replace("]","")},a.prototype.onExpandMore=function(e){var e=e.data.adminShipmentModal,o=e.$modal.find(".show-more-wrapper"),a=i(this).parents(".show-more-trigger");return o.show(),o.find(":input:visible").trigger("change",[e]),a.find(".show-more").hide(),a.find(".show-fewer").show(),!1},a.prototype.onHideMore=function(e){var e=e.data.adminShipmentModal.$modal.find(".show-more-wrapper"),o=i(this).parents(".show-more-trigger");return e.hide(),o.find(".show-further-services").show(),o.find(".show-fewer-services").hide(),!1},a.prototype.onChangeField=function(e){var o,e=e.data.adminShipmentModal,a=e.$modal,t=e.parseFieldId(i(this).attr("id")),n=i(this).val();i(this).attr("max")&&(o=i(this).attr("max"))<n&&i(this).val(o),i(this).attr("min")&&n<(o=i(this).attr("min"))&&i(this).val(o),i(this).hasClass("show-if-trigger")?0<(o=a.find(i(this).data("show-if"))).length&&(i(this).is(":checked")?o.show():o.hide(),i(d.body).trigger("wc_gzd_admin_shipment_modal_show_if",[e]),e.$modalTrigger.trigger("wc_gzd_admin_shipment_modal_show_if",[e])):(a.find(":input[data-show-if-"+t+"]").parents(".form-field").hide(),i(this).is(":checkbox")?i(this).is(":checked")&&a.find(":input[data-show-if-"+t+"]").parents(".form-field").show():a.find(":input[data-show-if-"+t+'*="'+n+'"]').parents(".form-field").show())},a.prototype.onClose=function(e,o){e=e.data.adminShipmentModal;-1!==o.indexOf(e.modalId)&&e.$modal&&0<e.$modal.length&&e.$modal.off("click.gzd-modal-"+e.modalId)},a.prototype.onOpen=function(e,o){e=e.data.adminShipmentModal;-1!==o.indexOf(e.modalId)&&(e.setup(),e.$modal=i("."+e.modalClass),e.$modal.data("self",e),e.loadAsync?(params={action:e.getAction("load"),reference_id:e.referenceId,security:e.getNonce("load")},e.doAjax(params,e.onLoadSuccess)):e.initData(),i(d.body).trigger("wc_gzd_admin_shipment_modal_open",[e]),e.$modalTrigger.trigger("wc_gzd_admin_shipment_modal_open",[e]))},a.prototype.onLoadSuccess=function(e,o){o.initData(),i(d.body).trigger("wc_gzd_admin_shipment_modal_after_load_success",[e,o]),o.$modalTrigger.trigger("wc_gzd_admin_shipment_modal_after_load_success",[e,o])},a.prototype.onAjaxSuccess=function(e,o){},a.prototype.onAjaxError=function(e,o){},a.prototype.getModalMainContent=function(){return this.$modal.find("article")},a.prototype.doAjax=function(e,o,a){var t=this,n=t.getModalMainContent();o=o||t.onAjaxSuccess,a=a||t.onAjaxError,e.hasOwnProperty("reference_id")||(e.reference_id=t.referenceId),t.$modal.find(".wc-backbone-modal-content").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),t.$modal.find(".notice-wrapper").empty(),i.ajax({type:"POST",url:t.params.ajax_url,data:e,success:function(e){e.success?(e.fragments&&i.each(e.fragments,function(e,o){i(e).replaceWith(o)}),t.$modal.find(".wc-backbone-modal-content").unblock(),o.apply(t,[e,t]),r.admin.shipments&&r.admin.shipments.refresh(e),i(d.body).trigger("wc_gzd_admin_shipment_modal_ajax_success",[e,t]),t.$modalTrigger.trigger("wc_gzd_admin_shipment_modal_ajax_success",[e,t]),e.fragments&&t.afterRefresh()):(t.$modal.find(".wc-backbone-modal-content").unblock(),a.apply(t,[e,t]),t.printNotices(n,e),n.animate({scrollTop:0},500),i(d.body).trigger("wc_gzd_admin_shipment_modal_ajax_error",[e,t]),t.$modalTrigger.trigger("wc_gzd_admin_shipment_modal_ajax_error",[e,t]))},error:function(e){},dataType:"json"})},a.prototype.afterRefresh=function(){0===this.$modal.find(".notice-wrapper").length&&this.getModalMainContent().prepend('<div class="notice-wrapper"></div>'),i(d.body).trigger("wc-enhanced-select-init"),i(d.body).trigger("wc-init-datepickers"),i(d.body).trigger("init_tooltips")},a.prototype.initData=function(){var e=this;e.$modal=i("."+e.modalClass),e.$modal.data("self",e),e.afterRefresh(),e.$modal.on("click.gzd-modal-"+e.modalId,"#btn-ok",{adminShipmentModal:e},e.onSubmit),e.$modal.on("touchstart.gzd-modal-"+e.modalId,"#btn-ok",{adminShipmentModal:e},e.onSubmit),e.$modal.on("keydown.gzd-modal-"+e.modalId,{adminShipmentModal:e},e.onKeyDown),e.$modal.on("click.gzd-modal-"+e.modalId,".notice .notice-dismiss",{adminShipmentModal:e},e.onRemoveNotice),e.$modal.on("change.gzd-modal-"+e.modalId,":input:visible[id]",{adminShipmentModal:e},e.onChangeField),e.$modal.on("click.gzd-modal-"+e.modalId,".show-more",{adminShipmentModal:e},e.onExpandMore),e.$modal.on("click.gzd-modal-"+e.modalId,".show-fewer",{adminShipmentModal:e},e.onHideMore),i(d.body).trigger("wc_gzd_admin_shipment_modal_after_init_data",[e]),e.$modalTrigger.trigger("wc_gzd_admin_shipment_modal_after_init_data",[e]),e.$modal.find(":input:visible").trigger("change",[e])},a.prototype.printNotices=function(t,e){var n=this;e.hasOwnProperty("message")?n.addNotice(e.message,"error",t):e.hasOwnProperty("messages")&&i.each(e.messages,function(a,e){"string"==typeof e||e instanceof String?n.addNotice(e,"error",t):i.each(e,function(e,o){n.addNotice(o,"soft"===a?"warning":a,t)})})},a.prototype.onSubmitSuccess=function(e,o){var a=o.getModalMainContent();e.hasOwnProperty("messages")&&(e.messages.hasOwnProperty("error")||e.messages.hasOwnProperty("soft"))?(o.printNotices(a,e),o.$modal.find("footer").find("#btn-ok").addClass("modal-close").attr("id","btn-close").text(o.params.i18n_modal_close)):o.$modal.find(".modal-close").trigger("click"),e.hasOwnProperty("shipment_id")&&0<i("div#shipment-"+e.shipment_id).length&&r.admin.shipments.initShipment(e.shipment_id),i(d.body).trigger("wc_gzd_admin_shipment_modal_after_submit_success",[e,o]),o.$modalTrigger.trigger("wc_gzd_admin_shipment_modal_after_submit_success",[e,o])},a.prototype.getCleanId=function(e=!1){var o=this.modalClass.split("-").join("_").replace("_modal_","_");return o=e?o.replace("wc_gzd_","").replace("wc_gzdp_",""):o},a.prototype.getNonceParams=function(){return o.hasOwnProperty(this.nonceParams)?o[this.nonceParams]:{}},a.prototype.getNonce=function(e){var o=this.getCleanId(!0)+"_"+e+"_nonce",a=this.getNonceParams();return a.hasOwnProperty(o)?a[o]:this.params[e+"_nonce"]},a.prototype.getAction=function(e){return this.getCleanId().replace("wc_","woocommerce_")+"_"+e},a.prototype.onKeyDown=function(o){var a=o.data.adminShipmentModal;13!==(o.keyCode||o.which)||o.target.tagName&&("input"===o.target.tagName.toLowerCase()||"textarea"===o.target.tagName.toLowerCase())||a.onSubmit.apply(a.$modal.find("button#btn-ok"),[e])},a.prototype.getFormData=function(e){var a={};return e.find(".show-more-wrapper").each(function(){i(this).is(":visible")||i(this).addClass("show-more-wrapper-force-show").show()}),i.each(e.find(":input:visible").serializeArray(),function(e,o){-1!==o.name.indexOf("[]")?(o.name=o.name.replace("[]",""),a[o.name]=i.makeArray(a[o.name]),a[o.name].push(o.value)):a[o.name]=o.value}),e.find(".show-more-wrapper-force-show").each(function(){i(this).removeClass("show-more-wrapper-force-show").hide()}),a},a.prototype.onSubmit=function(e){var o=e.data.adminShipmentModal,a=o.getModalMainContent().find("form"),a=o.getFormData(a);a.security=o.getNonce("submit"),a.reference_id=o.referenceId,a.action=o.getAction("submit"),o.doAjax(a,o.onSubmitSuccess),e.preventDefault(),e.stopPropagation()},a.prototype.addNotice=function(e,o,a){a.find(".notice-wrapper").append('<div class="notice is-dismissible notice-'+o+'"><p>'+e+'</p><button type="button" class="notice-dismiss"></button></div>')},a.prototype.response=function(e,o,a){e=e.data.adminShipmentModal;-1!==o.indexOf(e.modalId)&&(i(d.body).trigger("wc_gzd_admin_shipment_modal_response",[e,a]),e.$modalTrigger.trigger("wc_gzd_admin_shipment_modal_response",[e,a]))},i.fn.wc_gzd_admin_shipment_modal=function(){return this.each(function(){return new a(i(this)),this})}}(jQuery,window,document,window.germanized);