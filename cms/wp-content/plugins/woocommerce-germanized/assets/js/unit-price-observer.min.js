!function(c,t){function r(r){var e,a=this;if(a.params=wc_gzd_unit_price_observer_params,a.$wrapper=r.closest(a.params.wrapper),a.$form=0<a.$wrapper.find(".variations_form, .cart").length&&a.$wrapper.find(".variations_form, .cart"),a.isVar=!!a.$form&&a.$form.hasClass("variations_form"),a.$product=a.$wrapper.closest(".product"),a.requests=[],a.observer={},a.timeout=!1,a.priceData=!1,a.productId=0,a.$wrapper.length<=0&&(a.$wrapper=a.$product),a.replacePrice=!a.$wrapper.hasClass("bundled_product")&&a.params.replace_price,"MutationObserver"in t||"WebKitMutationObserver"in t||"MozMutationObserver"in t){if(a.$wrapper.addClass("has-unit-price-observer"),a.initObservers(a),a.isVar&&a.$form?(a.productId=parseInt(0<a.$form.find("input[name=product_id]").length?a.$form.find("input[name=product_id]").val():a.$form.data("product_id")),a.variationId=parseInt(0<a.$form.find("input[name=variation_id]").length?a.$form.find("input[name=variation_id]").val():0),a.$form.find("input[name=variation_id]").length<=0&&(a.variationId=parseInt(0<a.$form.find("input.variation_id").length?a.$form.find("input.variation_id").val():0)),a.$form.on("reset_data.unit-price-observer",{GermanizedUnitPriceObserver:a},a.onResetVariation),a.$form.on("found_variation.unit-price-observer",{GermanizedUnitPriceObserver:a},a.onFoundVariation)):a.$form&&0<a.$form.find("*[name=add-to-cart][type=submit]").length?a.productId=parseInt(a.$form.find("*[name=add-to-cart][type=submit]").val()):a.$form&&a.$form.data("product_id")?a.productId=parseInt(a.$form.data("product_id")):(e=a.$product.attr("class").split(/\s+/),c.each(e,function(r,e){if("post-"===e.substring(0,5)){e=parseInt(e.substring(5).replace(/[^0-9]/g,""));if(0<e)return a.productId=e,!0}}),a.productId<=0&&1===a.$product.find("a.ajax_add_to_cart[data-product_id], a.add_to_cart_button[data-product_id]").length&&(a.productId=parseInt(a.$product.find("a.ajax_add_to_cart, a.add_to_cart_button").data("product_id")))),a.productId<=0)return a.destroy(a),!1;a.params.refresh_on_load&&c.each(a.params.price_selector,function(e,t){var i=!!t.hasOwnProperty("is_primary_selector")&&t.is_primary_selector,r=a.getPriceNode(a,e,i),n=a.getUnitPriceNode(a,r);i&&0<n.length&&(a.stopObserver(a,e),a.setUnitPriceLoading(a,n),setTimeout(function(){a.stopObserver(a,e);var r=a.getCurrentPriceData(a,e,t.is_total_price,i,t.quantity_selector);r?a.refreshUnitPrice(a,r,e,i):0<n.length&&a.unsetUnitPriceLoading(a,n),a.startObserver(a,e,i)},250))})}r.data("unitPriceObserver",a)}r.prototype.destroy=function(r){(r=r||this).cancelObservers(r),r.$form&&r.$form.off(".unit-price-observer"),r.$wrapper.removeClass("has-unit-price-observer")},r.prototype.getTextWidth=function(r){var e=r.html();r.html("<span>"+e+"</span>");var t=r.find("span:first").width();return r.html(e),t},r.prototype.getPriceNode=function(r,e,t){t=void 0!==t&&t;e=r.$wrapper.find(e+":not(.price-unit):visible").not(".variations_form .single_variation .price").first();return t&&r.isVar&&(e.length<=0||!r.replacePrice)?e=r.$wrapper.find(".woocommerce-variation-price span.price:not(.price-unit):visible:last"):t&&e.length<=0&&(e=r.$wrapper.find(".price:not(.price-unit):visible:last")),e},r.prototype.getObserverNode=function(r,e,t){e=r.getPriceNode(r,e,t);return e=t&&r.isVar&&!r.replacePrice?r.$wrapper.find(".single_variation:last"):e},r.prototype.getUnitPriceNode=function(r,e){return e.length<=0?[]:"SPAN"===e[0].tagName?r.$wrapper.find(".price-unit"):r.$wrapper.find(".price-unit:not(.wc-gzd-additional-info-placeholder, .wc-gzd-additional-info-loop)")},r.prototype.stopObserver=function(r,e){e=r.getObserver(r,e);e&&e.disconnect()},r.prototype.startObserver=function(r,e,t){var i=r.getObserver(r,e),t=r.getObserverNode(r,e,t);return!!i&&(r.stopObserver(r,e),0<t.length&&i.observe(t[0],{childList:!0,subtree:!0,characterData:!0}),!0)},r.prototype.initObservers=function(p){0===Object.keys(p.observer).length&&c.each(p.params.price_selector,function(a,o){var r,s=!!o.hasOwnProperty("is_primary_selector")&&o.is_primary_selector,e=!1;0<p.getObserverNode(p,a,s).length&&(r=function(r,e){var t=p.getPriceNode(p,a,s);if(p.timeout&&clearTimeout(p.timeout),t.length<=0)return!1;var i=p.getUnitPriceNode(p,t),n=!1;p.stopObserver(p,a),0<i.length&&p.setUnitPriceLoading(p,i),p.timeout=setTimeout(function(){p.stopObserver(p,a);var r=p.getCurrentPriceData(p,a,o.is_total_price,s,o.quantity_selector);r&&c.active<=0&&(n=!0,p.refreshUnitPrice(p,r,a,s)),!n&&0<i.length&&p.unsetUnitPriceLoading(p,i),p.startObserver(p,a,s)},500)},"MutationObserver"in t?e=new t.MutationObserver(r):"WebKitMutationObserver"in t?e=new t.WebKitMutationObserver(r):"MozMutationObserver"in t&&(e=new t.MozMutationObserver(r)),e&&(p.observer[a]=e,p.startObserver(p,a,s)))})},r.prototype.getObserver=function(r,e){return!!r.observer.hasOwnProperty(e)&&r.observer[e]},r.prototype.cancelObservers=function(r){for(var e in r.observer)r.observer.hasOwnProperty(e)&&(r.observer[e].disconnect(),delete r.observer[e])},r.prototype.onResetVariation=function(r){r.data.GermanizedUnitPriceObserver.variationId=0},r.prototype.onFoundVariation=function(r,e){r=r.data.GermanizedUnitPriceObserver;e.hasOwnProperty("variation_id")&&(r.variationId=parseInt(e.variation_id)),r.initObservers(r)},r.prototype.getCurrentPriceData=function(r,e,t,i,n){n=n&&""!==n?n:r.params.qty_selector;var a=r.getPriceNode(r,e,i);if(0<a.length){var o=r.getUnitPriceNode(r,a),s=a.clone();s.find(".woocommerce-price-suffix").remove();e="",i=s.find(".amount:first"),a=c(r.params.wrapper+" "+n+":first"),n=1;0<a.length&&(n=parseFloat(a.val())),i.length<=0&&(i=0<s.find(".price").length?s.find(".price"):s);i=r.getRawPrice(i,r.params.price_decimal_sep);if(1<s.find(".amount").length&&(s=c(s.find(".amount")[1]),e=r.getRawPrice(s,r.params.price_decimal_sep)),0<o.length&&i)return t&&(i=parseFloat(i)/n,0<e.length&&(e=parseFloat(e)/n)),{price:i,unit_price:o,sale_price:e,quantity:n}}return!1},r.prototype.getCurrentProductId=function(r){var e=r.productId;return 0<r.variationId&&(e=r.variationId),parseInt(e)},r.prototype.getRawPrice=function(e,r){var t=0<e.length?e.text():"",e=!1;try{e=accounting.unformat(t,r)}catch(r){e=!1}return e},r.prototype.setUnitPriceLoading=function(r,e){var t,i=e.html();return e.hasClass("wc-gzd-loading")?i=e.data("org-html"):(t=r.getTextWidth(e),r=0<e.find("span").length?e.find("span").innerHeight():e.height(),e.html('<span class="wc-gzd-placeholder-loading"><span class="wc-gzd-placeholder-row" style="height: '+e.height()+'px;"><span class="wc-gzd-placeholder-row-col-4" style="width: '+t+"px; height: "+r+'px;"></span></span></span>'),e.addClass("wc-gzd-loading"),e.data("org-html",i)),i},r.prototype.unsetUnitPriceLoading=function(r,e,t){t=t||e.data("org-html"),e.html(t),e.hasClass("wc-gzd-loading")&&e.removeClass("wc-gzd-loading").show()},r.prototype.refreshUnitPrice=function(r,e,t,i){germanized.unit_price_observer_queue.add(r,r.getCurrentProductId(r),e,t,i)},c.fn.wc_germanized_unit_price_observer=function(){return c(this).data("unitPriceObserver")&&c(this).data("unitPriceObserver").destroy(),new r(this),this},c(function(){"undefined"!=typeof wc_gzd_unit_price_observer_params&&c(wc_gzd_unit_price_observer_params.wrapper).each(function(){c(this).wc_germanized_unit_price_observer()})})}(jQuery,window,document),window.germanized=window.germanized||{};